<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>jQuery Mobile: Theme Download</title>
        <link rel="stylesheet" href="{{url_for('static', filename='css/rostopic-web.min.css')}}" />
        <link rel="stylesheet" href="{{url_for('static', filename='css/jquery.mobile.icons.min.css')}}" />
        <link rel="stylesheet" href="{{url_for('static', filename='css/jquery.mobile-1.4.5.css')}}" />
        <link rel="stylesheet" href="{{url_for('static', filename='css/jstree.style.css')}}" />

        <script src="{{url_for('static', filename='js/jquery-2.1.4.min.js')}}"></script>
        <!--<script src="{{url_for('static', filename='js/jquery.forwardevents.js')}}"></script>-->
        <script src="{{url_for('static', filename='js/jquery.mobile-1.4.5.min.js')}}"></script>
        <script src="{{url_for('static', filename='js/svg-pan-zoom.js')}}"></script>
        <script src="{{url_for('static', filename='js/hammer.js')}}"></script>
        <script src="{{url_for('static', filename='js/resizable_canvas.js')}}"></script>
        <script src="{{url_for('static', filename='js/jstree.js')}}"></script>
        <script>
          $(document).ready(ready());
          function ready() {
          	$.subscriptions = {};
          }
          function echo_button_click(){
            console.log($.selected_topic);
            if(!$.selected_topic in $.subscriptions) {
            	$.getJSON({
            		url: '/subscribe', 
					data : {topic : $.selected_topic }, 
					success: function(data) { 
						console.log("hoallalalala");
						open_echo_panel($.selected_topic);}
					});
            }
            else {
            	open_echo_panel($.selected_topic);
            }
          }

          function open_echo_panel(topic_name) {
          	activate(topic_name);
          }

          function publish_button_click() {
            console.log("Publish");
            return false;
          }

        </script>
        }

    </head>
    <body>
        <div data-role="page" data-theme="a">
            <div data-role="panel" id="leftpanel" data-display="overlay" >
                <h2>Panel Header</h2>
                <div class="ui-grid-a" data-role="collapsible" id="publishing-collapsible">
                    <h4>Publishing</h4>
                    <a href="#leftpanel" id="publishingtogglebutton" data-role="button" data-icon="arrow-d">Publishing</a>
                </div>
                <div class="ui-grid-a" data-role="collapsible" id="echoing-collapsible">
                    <h4>Echoing</h4>
                    <a href="#leftpanel" id="publishingtogglebutton" data-role="button" data-icon="arrow-d">Echoing</a>
                </div>
            </div>

            <div data-role="panel" id="rightpanel" data-display="overlay" data-position="right" >
            	<div id="echopanel">{% include "echo.html" %}</div>
            </div>

            <div data-role="header" data-position="inline">
                <a href="#leftpanel" id="lpaneltogglebutton" data-role="button" data-icon="grid" data-mini="true" data-inline="true" data-iconpos="notext"></a>

                <h1>Nodes and topics diagram</h1>
            </div>
            <div data-role="content" data-theme="a">
                <div class="image-div"  style="text-align:center">
                    <section style="margin:auto;">
                        <!--<h1>WebTopic</h1>-->
                        <object class="panzoom" id="svg-container" data='{{ svg_filename }}' style="width: 98%; height: 50%; horizontal-align:middle; border:1px solid black; " type="image/svg+xml" ></object>
                    </section>

                </div>
                <div class="page-content">
                    <div id="topic_msg_type" style="margin-left:1%;">Topic:<br>Type:</div>
                    <!--
                    <p>This is content color swatch "A" and a preview of a <a href="#" class="ui-link">link</a>.</p>
                    <label for="slider1">Input slider:</label>
                    <input type="range" name="slider1" id="slider1" value="50" min="0" max="100" data-theme="a" />
                    <fieldset data-role="controlgroup"  data-type="horizontal" data-role="fieldcontain">
                        <legend>Cache settings:</legend>
                        <input type="radio" name="radio-choice-a1" id="radio-choice-a1" value="on" checked="checked" />
                        <label for="radio-choice-a1">On</label>
                        <input type="radio" name="radio-choice-a1" id="radio-choice-b1" value="off"  />
                        <label for="radio-choice-b1">Off</label>
                    </fieldset>
                    -->
                </div>
            </div>
            <div data-role="footer" data-position="inline">
                Echo:
                <a onClick="echo_button_click();" href="#rightpanel" data-role="button" data-icon="audio" data-mini="true" data-inline="true" data-iconpos="notext"></a>
                Publish:
                <a onClick="publish_button_click();" href="#" data-role="button" data-icon="edit" data-mini="true" data-inline="true" data-iconpos="notext"></a>
            </div>
        </div>
    </body>
</html>
